<!-- Previous code remains the same until the calculateScore function -->

<script>
    function calculateScore() {
        const scores = [];
        for (let i = 1; i <= 12; i++) {
            const score = document.getElementById(`q${i}`).value;
            if (score) scores.push(parseInt(score));
        }

        if (scores.length < 12) {
            alert("Please answer all questions");
            return;
        }

        const totalScore = scores.reduce((a, b) => a + b, 0);
        const average = totalScore / scores.length;
        let grade = '';
        let explanation = '';

        if (average >= 3.5) {
            grade = 'A';
            explanation = 'Excellent! Your organization demonstrates strong value intelligence capabilities across all dimensions. You have a mature approach to understanding, delivering, and measuring customer value.';
        } else if (average >= 3) {
            grade = 'B';
            explanation = 'Good performance! While you have solid value intelligence practices in place, there are opportunities to enhance certain areas for even better results.';
        } else if (average >= 2) {
            grade = 'C';
            explanation = 'Fair performance. Your organization has basic value intelligence practices, but significant improvements could be made to better understand and deliver customer value.';
        } else {
            grade = 'D';
            explanation = 'Your value intelligence practices need attention. Consider focusing on developing stronger frameworks for understanding, measuring, and delivering customer value.';
        }

        document.getElementById('results').innerHTML = `
            <div style="background-color: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #007bff;">
                <h3 style="color: #007bff; margin-bottom: 15px;">Your Value Intelligence Results</h3>
                <div style="margin-bottom: 15px;">
                    <strong>Total Score:</strong> ${totalScore}/48<br>
                    <strong>Average:</strong> ${average.toFixed(2)}<br>
                    <strong>Grade:</strong> ${grade}
                </div>
                <div style="color: #666; line-height: 1.5;">
                    <strong>What this means:</strong><br>
                    ${explanation}
                </div>
            </div>
        `;
    }
</script>
